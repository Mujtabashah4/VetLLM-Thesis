



\chapter{Simulations, Performance Analysis and Evaluations\label{chap6:chapter6}


\section{Introduction}


In obtaining the SLSHT distribution presented in
Chapter~\ref{chap4:chapter4} for spatio-spectral representation of a
signal, we used an azimuthally symmetric window function for spatial
localization. The use of azimuthally symmetric window provides
simplification in the sense that each component of the SLSHT
distribution is defined on $\untsph$. However, the use of
an azimuthally symmetric window function cannot discriminate localized
directional features in the spatio-spectral domain. Here, we extend
the definition of SLSHT distribution presented in
Chapter~\ref{chap4:chapter4} and propose a transform for signals
defined on the sphere that reveals their localized directional
content in the spatio-spectral domain when used in conjunction with
an asymmetric window function. We call this transform the
directional spatially localized spherical harmonic transform
(directional SLSHT). We present an inversion relation to synthesize
the original signal from its directional-SLSHT distribution for an
arbitrary window function. As an example of an asymmetric window, we
propose to use the most concentrated band-limited eigenfunction in
an elliptical region for spatial localization. As an illustration,
we apply the proposed directional SLSHT on the Mars topographic
data-set and show its capability to reveal directional features in
spatio-spectral domain. Finally, since such typical data-sets on the
sphere are of considerable size and the directional SLSHT is
intrinsically computationally demanding depending on the band-limits
of the signal and window, we develop a fast algorithm for
efficient computation of the transform.  The floating point
precision numerical accuracy of the fast algorithm is demonstrated
and a full numerical complexity analysis is presented.

This chapter is organized as follows. We present the formulation of
the directional SLSHT, its harmonic analysis and signal
reconstruction from the SLSHT distribution in
Section~\ref{sec:SLSHT}. Different algorithms for evaluation of
the SLSHT distribution are provided in Section~\ref{sec:Algos} and
detailed analysis of the asymmetric window function is presented
in Section~\ref{sec:Window}. In Section~\ref{sec:results}, we show
timing and accuracy results of our algorithms and an illustration of
the transform.



\section{Directional SLSHT}\label{sec:SLSHT}

We describe in this section the directional SLSHT, which is capable
of revealing directional features of signals in the
spatio-spectral\footnote{In this chapter, when we refer to
spatio-spectral, we consider the SO(3) spatial domain, instead of
$\mathbb{S}^2$. This is because that we are considering
all possible rotations, parameterized using Euler angles which form
the SO(3) domain.} domain.
%
For spatial localization, we consider the band-limited azimuthally
asymmetric window function which is spatially concentrated in some
asymmetric region around the north pole. Since the rotation around
the \mbox{$z$-axis} does not have any effect on an azimuthally
symmetric function, the localized spherical harmonic transform using
an azimuthally symmetric window function can be parameterized on the
sphere.  However, if an azimuthally asymmetric window is used to
obtain localization in the spatial domain, the rotation of the
window function is fully parameterized with the consideration of all
three Euler angles $(\varphi,\vartheta,\omega) \in\,$SO($3$). We
refer to the spatially localized transform using an asymmetric
window as the directional SLSHT. Here, we first define the
directional SLSHT distribution which presents the signal in the
spatio-spectral domain. Later in this section, we present the
harmonic analysis of SLSHT distribution and provide an inversion
relation to obtain the signal from its given directional SLSHT
distribution.

\subsection{Forward Directional SLSHT }
\begin{definition}[{Directional SLSHT}] For a
  signal \mbox{$f\in\lsph$}, define the directional SLSHT distribution
  component ${g}(\rho;\ell,m) \in L^2(\emph{SO(3)})$ of degree $\ell$ and order
  $m$ as the spherical harmonic transform of a localized signal where
  localization is provided by the rotation operator $\mathcal{D}_\rho$ acting on the window function
  $h\in\lsph$, i.e.,
%
\begin{align}\label{Eq:stft_spatial}
g(\rho;\ell,m) %&\triangleq \intsph f(\Omega')\,w(\Omega', \Omega)\,\overline{Y_c(\Omega')}\,d\Omega'\\
&\triangleq \intsph f(\unit{x})\,\big(\mathcal{D}_\rho
h\big)(\unit{x})\,\overline{Y_\ell^m(\unit{x})}\,ds(\unit{x})
\end{align}
%
for $0\leq \ell \leq L_g,\,|m|\leq \ell$, where $L_g=L_f+L_h$
denotes the maximum spherical harmonic degree for which the
distribution components $g(\rho;\ell,m)$ are non-zero, and $L_f$ and
$L_h$ denote the band-limits of the signal $f$ and the window
function $h$, respectively. Also, each distribution component
$g(\rho;\ell,m)$ is band-limited in
$\rho=(\varphi,\vartheta,\omega)\in {\rm SO(3)}$ with maximum degree
$L_h$, i.e., when expressed in terms of Wigner-$D$ functions. We
elaborate on this later in this chapter. Furthermore, we consider
unit energy normalized window functions such that $\langle h,h
\rangle=1$.
\end{definition}


\begin{remark}
The directional SLSHT distribution component in
\eqref{Eq:stft_spatial} can be interpreted as the spherical harmonic
transform of the localized signal where the window function $h$
provides asymmetric localization at spatial position $\unit{x} =
\unit{x}(\vartheta,\varphi)\in\mathbb{S}^2$ and the first rotation,
through $\omega$, determines the orientation of the window function
at $\unit{x}$. If the window function is azimuthally symmetric, this
orientation of the window function by $\omega$ becomes invariant and
the SLSHT distribution components are defined on $\lsph$ as
presented in Chapter~\ref{chap4:chapter4}.
\end{remark}
%

Since the maximum spectral degree for which the SLSHT distribution
is defined is $L_g = L_f + L_h$, we consider the band-limited window
function such that $L_h\leq L_f$ to avoid extending $L_g$
significantly above $L_f$. We discuss the localization of the window
function in the spatial and spectral domains later in the chapter.

In order to represent functions on $\mathbb{S}^2$ and
$\textrm{SO(3)}$, it is necessary to adopt appropriate tessellation
schemes to discretize both the unit sphere domain and the Euler
angle domain of SO(3). We first describe our chosen tessellation
schemes and then we provide harmonic analysis of directional SLSHT
and the inversion of signal from direction SLSHT.

\subsection{Discretization of $\mathbb{S}^2$ and ${\textrm{SO(3)}}$}
\label{sec:models_samples}
%
We consider tessellation~(sampling) schemes that support a sampling theorem for
band-limited functions, which is equivalent to supporting an exact
quadrature.

For the unit sphere domain, we adopt the equiangular tessellation
scheme~\cite{McEwen:2011} defined as $\mathfrak{S}_{L}
=\{\theta_{n_\theta} = \pi (2n_\theta+1)/(2L+1),\,\phi_{n_\phi} =
2\pi n_\phi/(2L+1):\,0 \leq n_\theta \leq L,\, 0 \leq \,n_\phi \leq
2L\}$, which is a grid of $(L+1)\times (2L+1)$ sample points on the
sphere (including repeated samples of the south pole) that keeps the
sampling in $\theta$ and $\phi$ independent. For a band-limited
function on the sphere $f \in \lsph$ with maximum spherical harmonic
degree $L_f$, sampling on the grid $\mathfrak{S}_{L_f}$ ensures
that all information of the function is captured in the finite set
of samples and, moreover, that exact quadrature can be performed
\cite{McEwen:2011}. Note that this sampling theorem was developed
only recently \cite{McEwen:2011} and requires approximately half as
many samples on the sphere as required by alternative equiangular
sampling theorems on the sphere \cite{Driscoll:1994}.

For the Euler angle representation of the rotation group SO(3), we
consider the equiangular tessellation scheme $\mathfrak{E}_{L} =\{
\varphi_{n_\varphi} = 2\pi n_\varphi/(2L+1),\,
\vartheta_{n_\vartheta} = 2\pi
n_\vartheta/(2L+1),\,\omega_{n_\omega} = 2\pi n_\omega/(2L+1):\, 0
\leq n_\varphi,n_\omega \leq {2L},\, 0 \leq n_\vartheta\leq L \}$.
Again for a function $f\in \lsoo$ with maximum spectral degree
$L_f$, the sampling of a function $f$ on $\mathfrak{E}_{L_f}$
ensures that all information of the function is captured and also
permits exact quadrature (which follows from the results developed
on the sphere \cite{McEwen:2011}).
%
%%----------------------------------------------------------------------


\subsection{Harmonic Analysis}

We now present the formulation of the directional SLSHT distribution
if the signal $f$ and the window function $h$ are represented in the
spectral domain. Using the expression for the spherical harmonics of
a rotated function in \eqref{eqn:rotation_non_symm}, we can write
the SLSHT distribution component $g(\rho;\ell,m)$ in
\eqref{Eq:stft_spatial} as
%
\begin{align}\label{Eq:harmonic_formulation}
g(\rho;\ell,m)\, &=\,\sum_{\ell'=0}^{L_f}\sum_{m'=-\ell'}^{\ell'}
\shc{f}{\ell'}{m'} \sum_{p=0}^{ L_h}\sum_{q=-p}^p\sum_{q'=-p}^p
\shc{h}{p}{q'}\, D_p^{q,q'}(\rho)\,T(\ell',m';p,q;\ell,m),
\end{align}
%
where
%
\begin{align}
T(\ell',m';p,q;\ell,m) = \intsph
Y_{\ell'}^{m'}(\unit{x})\,Y_p^q(\unit{x})\,\overline{Y_\ell^m(\unit{x})}\,
ds(\unit{x}) \nonumber
\end{align}
%
denotes the spherical harmonic triple product and is given in
\eqref{Eq:triple_prod_abc} and \eqref{Eq:Def_triple_product}.

\begin{remark}
  By comparing $g(\rho;\ell,m)$ in \eqref{Eq:harmonic_formulation}
  with \eqref{Eq:g_expansion_Wigner}, we note that the band-limit
  of $g(\rho;\ell,m)$ in $\rho$ is given by $L_h$. Since $\ell'\leq L_f$ and $p
  \leq L_h$ in \eqref{Eq:harmonic_formulation}, our statement that the
  distribution component $g(\rho;\ell,m)$ is non-zero for $\ell \leq
  L_g=L_f+L_h$ follows since the triple product $T(\ell',m';p,q;\ell,m)$ is non-zero for $\ell\leq L_f + L_h$ only.
\end{remark}

\subsection{Inverse Directional SLSHT}

Here, we define the inverse directional SLSHT to reconstruct a
signal from its SLSHT distribution. The original signal can be
reconstructed from its directional SLSHT distribution through the
spectral domain marginal, that is, by integrating the SLSHT
distribution components over the spatial domain
SO(3)~\cite{Simons:1997}. Using our harmonic formulation in
\eqref{Eq:harmonic_formulation}, define $\shc{\hat{f}}{\ell}{m}$ as
the integral of the SLSHT distribution component $g(\rho;\ell,m)$
over SO(3) giving
%
\begin{align}\label{Eq:inversion_1}
\shc{\hat{f}}{\ell}{m} &=   \intso  g(\rho;\ell,m)  d\rho ,\quad 0
\leq \ell \leq L_f \nonumber
\\ &=
%
\sum_{\ell'=0}^{L_h}\sum_{m'=-\ell'}^{\ell'} \shc{f}{\ell'}{m'}
\sum_{p=0}^{ L_h}\sum_{q=-p}^p\sum_{q'=-p}^p \shc{h}{p}{q'}\,
T(\ell',m';p,q;\ell,m) \intso D_p^{q,q'}(\rho)\,d\rho
\nonumber \\
%
&= 8\pi^2 \sum_{\ell'=0}^{L_h}\sum_{m'=-\ell'}^{\ell'}
\shc{f}{\ell'}{m'}
 \shc{h}{0}{0}\,
T(\ell',m';0,0;\ell,m)
\nonumber \\
%
&=\sqrt{16\pi^3} \,\shc{h}{0}{0}\,\shc{f}{\ell}{m} ,
\end{align}
%
where we have used the orthogonality relation of Wigner-$D$
functions (see \eqref{Eq:WignerD_ortho}).
%
Using the expression in \eqref{Eq:inversion_1}, we can find the
spherical harmonic coefficient $\shc{f}{\ell}{m}$ of the signal $f$
as
%
\begin{align}\label{Eq:inversion_2}
\shc{f}{\ell}{m} = \frac{\shc{\hat{f}}{\ell}{m}}{\sqrt{16\pi^3}
\,\shc{h}{0}{0}} ,
\end{align}
%
which indicates that we only need to know the DC-component of the
window function $\shc{h}{0}{0}$ in order to obtain the signal from
its directional SLSHT distribution. It further imposes the condition
that the DC-component of the window function must be non-zero.
Although the distribution components in
\eqref{Eq:harmonic_formulation} are defined up to degree
$L_g=L_f+L_h$, we only require the components up to $L_f$ for signal
reconstruction.
%
\begin{remark}
The signal can also be reconstructed from its SLSHT distribution by
evaluating
\begin{align}
\intso g(\rho;\ell,m)\overline{D^p_{q,q'}(\rho)} d\rho &=
8\pi^2\sum_{\ell'=0}^{L_h}\sum_{m'=-\ell'}^{\ell'}
\shc{f}{\ell'}{m'} \sum_{p=0}^{ L_h}\sum_{q=-p}^p
\nonumber \\
& \times  \sum_{q'=-p}^p \frac{\shc{h}{p}{q'}}{2p+1}
T(\ell',m';p,q;\ell,m)
\end{align}
for all $p\leq L_h,\,|q|,\,q'|\leq p$ and for all $\ell\leq
L_g,\,|m|\leq \ell$ and then employing the orthogonality relations
of Wigner-$3j$ symbols to decouple the spherical harmonic
coefficients of the window function $h$ and the signal $f$. We used
this approach in Chapter~\ref{chap5:chapter5}~(see
Theorem~\ref{thm:approx_solution}) to invert the signal from its
modified SLSHT distribution, where the SLSHT distribution is
obtained using azimuthally symmetric window function. This approach
does not impose restriction on the DC-component of the window
function to be non-zero, instead, it requires the knowledge of the
energy of the window function. In this work, we consider the
inversion of a signal presented in \eqref{Eq:inversion_1} and
\eqref{Eq:inversion_2}, as this is the most efficient formulation in terms of computational complexity.
\end{remark}

Computing the forward and inverse directional SLSHT is
computationally demanding.  Since the directional SLSHT distribution
components $g(\rho;\ell,m)$ in \eqref{Eq:stft_spatial} are defined
for $\ell\leq L_g$, the number of distribution components are of the
order $L_g^2$, while the sampling of $\rho$ is of the order $L_h^3$;
thus, direct evaluation of the directional SLSHT distribution is
prohibitively computationally expensive for large values of $L_g$.  Therefore efficient
algorithms need to be developed which reduce the computational
complexity. We address this problem in the next section.
%
%%----------------------------------------------------------------------

\section{Efficient Computation of Directional SLSHT Distribution}\label{sec:Algos}

Here, we present efficient algorithms for the computation of the
directional SLSHT distribution of a signal and reconstruction of a signal
from its directional SLSHT distribution. First, we
discuss the computational complexities if the SLSHT distribution
components are computed using direct quadrature as given in
\eqref{Eq:stft_spatial} or using the harmonic formulation in
\eqref{Eq:harmonic_formulation}. Later, we develop an alternative
harmonic formulation which reduces the computational burden.
Finally, we present an efficient algorithm that incorporates a
factoring of rotations~\cite{Risbo:1996} and exploits the FFT.

First we need to parameterize the required tessellation schemes for
$\mathbb{S}^2$ for the representation of the signal $f$ and the
window $h$ and for SO(3) which forms the spatial domain of the
directional SLSHT distribution. Since the maximum spectral degree of
the signal $f$ is $L_f$, we therefore consider the equiangular
tessellation $\mathfrak{S}_{L_f}$ to represent $f$. Since the
maximum degree for all SLSHT distribution components
$g(\rho;\ell,m)$ in $\rho$ is $L_h$, we therefore consider the
tessellation $\mathfrak{E}_{L_h}$ to represent the SLSHT
distribution components on $\lsoo$.

\subsection{Direct Quadrature and Harmonic Formulation}
We define the forward spatio-spectral transform as evaluation of
each SLSHT distribution component $g(\rho;\ell,m)$. Evaluation of
the forward spatio-spectral transform using exact quadrature in
\eqref{Eq:stft_spatial} requires the computation of a two dimensional
summation over the tessellation of $\mathbb{S}^2$ for each $3$-tuple
$(\varphi,\vartheta,\omega)$. Since there are $O(L_h^3)$ such
$3$-tuples in the tessellation scheme $\mathfrak{E}_{L_h}$ and the
SLSHT distribution components are of the order $O(L_f^2)$, the
computational complexity to compute all distribution components
using direct quadrature is $O(L_f^4 L_h^3)$. Using the harmonic
formulation in \eqref{Eq:harmonic_formulation}, the complexity to
compute each SLSHT distribution component is $O(L_f^2 L_h^6)$ and to
compute all SLSHT distribution components is $O(L_f^4 L_h^6)$.
Although the harmonic formulation in \eqref{Eq:harmonic_formulation}
is useful to establish that the signal can be reconstructed from the
directional SLSHT distribution, it is much more computationally
demanding than direct quadrature. We develop efficient algorithms in
the next subsection which improve the computational complexity of
the harmonic formulation and make it more efficient than direct
quadrature.

For the inverse directional SLSHT distribution, we only need to
integrate over SO(3) to obtain the signal in the spherical harmonic
domain as proposed in \eqref{Eq:inversion_1}. Since the integral can
be evaluated by a summation over all Euler angles using quadrature
weights, an efficient way to recover the signal from its SLSHT
distribution is through direct quadrature, with complexity of
$O(L_h^3)$ for each distribution component and $O(L_f^2 L_h^3)$ for
all components.

In order to evaluate the integral in \eqref{Eq:inversion_1} exactly,
we need to define quadrature weights along Euler angle $\vartheta$
in the tessellation $\mathfrak{E}_{L_h}$. We evaluate the integral
in \eqref{Eq:inversion_1} by the following summation\footnote{In the
  evaluation of \eqref{Eq:sig_reconstruction_discrete} we have
  computed the summation over $2L_h+1$ sample points in both $\varphi$
  and $\omega$. This is due to the tessellation $\mathfrak{E}_{L_h}$
  required to capture the entire information content of
  $g(\varphi,\vartheta,\omega;\ell,m)$. However,
  if one were interested in recovering $f$ only, then
  given the quadrature rule in \cite{McEwen:2011}
  $\shc{\hat{f}}{\ell}{m}$ in \eqref{Eq:sig_reconstruction_discrete}
  could be computed exactly with only $L_h+1$ sample points in
  $\varphi$ and $\omega$. }
%
\begin{align}\label{Eq:sig_reconstruction_discrete}
\shc{\hat{f}}{\ell}{m} \,=\,
\frac{1}{(2L_h+1)^3}\sum_{n_\varphi=0}^{2L_h}
 \sum_{n_\vartheta=0}^{L_h} \sum_{n_\omega=0}^{2L_h}\,
 g(\varphi_{n_\varphi},\vartheta_{n_\vartheta},\omega_{n_\omega};\ell,m)\,q(\vartheta_{n_\vartheta}) ,
\end{align}
%
where the quadrature weights $q(\vartheta_{n_\vartheta})$ follow
from \cite{McEwen:2011}, with
%
\begin{align}
q(\vartheta_{n_\vartheta}) = \begin{cases}
                        4\pi^2 \big(\lfloor \frac{L_h}{2} \rfloor + \frac{1}{2}\big)^{-1},&  \vartheta_{n_\vartheta}=0; \\
                        8\pi^2\sum\limits_{m=-L_h}^{L_h}w(-m)\,\cos{m\vartheta_{n_\vartheta}},&  \textrm{otherwise}; \\
                     \end{cases}
\end{align}
where $w(m)$ is defined as~\cite{McEwen:2011}
\begin{align}
w(m) = \begin{cases}
        \frac{\pm i\pi}{2},\quad&m=\pm 1; \\
        0, & m\, \textrm{odd},\,m\neq1;\\
        \frac{2}{1-m^2}, & m\,\textrm{even}.
        \end{cases}
\end{align}

\subsection{Fast Algorithm for Forward Directional SLSHT}
\label{sec:Algos:fast} Here, we develop a fast algorithm to reduce
the computational complexity of the forward SLSHT.  We first
consider an alternative harmonic formulation of the forward SLSHT
and then employ the factoring of rotations approach which was first
proposed in \cite{Risbo:1996} and has been used in the
implementations of the fast spherical
convolution~\cite{Wandelt:2001} and the directional spherical
wavelet transform~\cite{McEwen:2007}.

We may write the directional SLSHT distribution component
$g(\rho;\ell,m)$ in \eqref{Eq:stft_spatial} as a spherical
convolution~\cite{McEwen:2007} of $h$ and the spherical harmonic
modulated signal $\overline{f}\,Y_\ell^m$, giving
%
\begin{align}\label{Eq:alternative_harmonic_formulation}
g(\rho;\ell,m)\, &=\, \sum_{p=0}^{ L_h}\sum_{q=-p}^p\sum_{q'=-p}^p
\overline{\shc{\overline{f}Y_\ell^m}{p}{q}} \shc{h}{p}{q'}\,
D_p^{q,q'}(\varphi,\vartheta,\omega),
\end{align}
%
which can be expressed, using the definition of the Wigner-$D$
function in \eqref{Eq:Dlm}, as
%
\begin{align}\label{Eq:alternative_harmonic_formulation_wigner}
g(\rho;\ell,m)\, &=\, \sum_{p=0}^{ L_h}\bigg(\sum_{q=-p}^p
\big(\sum_{q'=-p}^p \overline{\shc{\overline{f}Y_\ell^m}{p}{q}}
\shc{h}{p}{q'} \, d_p^{q,q'}(\vartheta) e^{-iq'\omega}\big)
e^{-iq\varphi}\bigg).
\end{align}

The band-limit of the spherical harmonic modulated signal
$\overline{f}\,Y_\ell^m$ is $L_f+\ell$.  Since the maximum $\ell$
for which $g$ is non-zero is $L_f+L_h$, we must compute up to
$\overline{f}\,Y_{L_f+L_h}^m$, which is band-limited to $2L_f+L_h$.
However, we \emph{only} need to compute the spherical harmonic
coefficients $\shc{\overline{f}Y_\ell^m}{p}{q}$ of the modulated
signal up to degree $p\leq L_h$, for all $\ell$ and $m$. Therefore,
the computation of the spherical harmonic transform of
$\overline{f}\,Y_\ell^m$ is an interesting sub-problem. In order to
serve the purpose, we use a separation of variable technique given by
%
\begin{align}\label{Eq:sht_sep_variable}
\shc{\overline{f}\,Y_\ell^m}{p}{q}  \,= N_\ell^m N_p^q \int_0^\pi
P_\ell^m(\cos\theta) P_p^q (\cos\theta) \underbrace{ \int_0^{2\pi}
\overline{f(\theta,\phi)}e^{i(m-q)\phi} d\phi}_{I(\theta,m-q)}
\sin\theta d\theta.
\end{align}
Since $0\leq \ell \leq L_f + L_h$ and $0\leq p \leq L_h$, we need to
consider the signal $\overline{f}\,Y_\ell^m$ sampled on the grid
$\mathfrak{S}_{2L_f+2L_h}$ for the explicit evaluation of exact
quadrature (note that sampling in $\phi$ could be optimized given
\mbox{$|m-q|\leq L_f+2L_h$} but this would require a different
tessellation of the sphere and will not alter the overall complexity
of the computation). Using \eqref{Eq:sht_sep_variable}, the integral
over $\phi$, giving $I(\theta,m-q)$, can be computed first in
$O(L_f^2 \log_2 L_f)$ for all $m-q$. Once $I(\theta,m-q)$ is
computed, the exact quadrature weights that follow from
\cite{McEwen:2011} can be used to evaluate the integral over
$\theta$ in $O(L_f)$ for each $p,\,q,\, \ell,\,m$ and in $O(L_f^3
L_h^2)$ for all $p,\,q,\, \ell,\,m$.  Thus the overall complexity to
compute the spherical harmonic transform of the modulated signal
${\overline{f}\,Y_\ell^m}$ up to degree $L_h$ is $ O(L_f^3 L_h^2)$.
%

By factoring the single rotation by $(\varphi,\vartheta, \omega)$
into two rotations~\cite{McEwen:2007,Risbo:1996,Wandelt:2001}
%
\begin{align}
\mathcal{D}_\rho = \mathcal{D}_{\rho_1}\,\mathcal{D}_{\rho_2},\quad
\rho = (\varphi,\vartheta,\omega),\,\rho_1 =
(\varphi-\pi/2,-\pi/2,\vartheta),\,\rho_2 = (0,\pi/2,\omega+\pi/2),
\end{align}
%
and noting the effect of rotation on spherical harmonic coefficients
in \eqref{eqn:rotation_non_symm}, we can write the Wigner-$D$
function in \eqref{Eq:Dlm} as
%
\begin{align}\label{Eq:WignerD_expansion_new}
D_p^{q,q'}(\varphi,\vartheta,\omega)
% &= e^{-iq\alpha-iq'\omega}
%  \, i^{q'-q}\,\sum_{q''=-p}^p
% \Delta^{p}_{q''q}\,\Delta^p_{q''q'} \,e^{iq''\vartheta} \nonumber\\
% &= e^{-iq\alpha-iq'\omega}  \, i^{q-q'}\,\sum_{q''=-p}^p
% \Delta^{p}_{q''q}\,\Delta^p_{q''q'}
% \,e^{-iq''\vartheta}\nonumber \\
&= \, i^{q-q'}\,\sum_{q''=-p}^p \Delta_{p}^{q''q}\,\Delta_p^{q''q'}
\,e^{-iq\varphi- iq''\vartheta - iq'\omega},
\end{align}
%
where $\Delta_p^{q q'} = d_p^{q,q'}(\pi/2)$ and we have used the
following symmetry properties of Wigner-$d$
functions~\cite{Varsha:1988}
%
\begin{align}
d^{q,q'}_{p}(\vartheta)= (-1)^{q-q'}d^{q,q'}_{p}(-\vartheta) =
(-1)^{q-q'} d^{-q,-q'}_{p}(\vartheta) = (-1)^{q-q'}
d^{q',q}_{p}(\vartheta) = d^{-q',-q}_{p}(\vartheta)
\end{align}
%
Using the Wigner-$D$ expansion given in
\eqref{Eq:WignerD_expansion_new}, we can write the alternative
harmonic formulation of the SLSHT distribution component
$g(\rho;\ell,m)$ in \eqref{Eq:alternative_harmonic_formulation} as
%
\begin{align}\label{Eq:alternative_harmonic_formulation_2}
g(\rho;\ell,m)\, &=\, \sum_{p=0}^{ L_h}\sum_{q=-p}^p \sum_{q'=-p}^p
\overline{\shc{\overline{f}Y_\ell^m}{p}{q}} \shc{h}{p}{q'}\,
i^{q-q'}\,\sum_{q''=-p}^p \Delta_{p}^{q''q}\,\Delta_p^{q''q'}
\,e^{-iq\varphi- iq''\vartheta - q'\omega},
\end{align}
%
where $\rho = (\varphi,\vartheta,\omega)$. By reordering the
summations we can write
%
\begin{align}\label{Eq:alternative_harmonic_formulation_2_2}
g(\rho;\ell,m)\, &=\, \sum_{q=-L_h}^{L_h}\sum_{q'=-L_h}^{L_h}
\,\sum_{q''=-L_h}^{L_h} C_{q,q',q''}(\ell,m) \,e^{-iq\varphi-
iq''\vartheta - q'\omega}, \quad \rho = (\varphi,\vartheta,\omega),
\end{align}
%
where
%
\begin{align}\label{Eq:constant_alternative_formulation}
C_{q,q',q''}(\ell,m) = i^{q-q'} \sum_{p=\max(|q|,|q'|,|q''|)}^{ L_h}
\Delta_{p}^{q''q}\,\Delta_p^{q''q'}
\overline{\shc{\overline{f}Y_\ell^m}{p}{q}} \shc{h}{p}{q'}.
\end{align}
%
Comparatively, computation of the SLSHT distribution components
using the expression given by
\eqref{Eq:alternative_harmonic_formulation_2_2} is not more
efficient than the initial expression
\eqref{Eq:alternative_harmonic_formulation_wigner}. However, the
presence of complex exponentials can be exploited by employing FFTs
to evaluate the involved summations.

The objective of factoring the rotations is to carry out the
$\vartheta$ rotation along the $y$-axis as a rotation along the
$z$-axis. The rotations along the $z$-axis are expressed using
complex exponentials and thus these rotations can be applied with
much less computational burden, by exploiting the power of an FFT,
relative to a rotation about the $y$-axis.
%
All three rotations which characterize the spatial domain of the
SLSHT distribution components appear in complex exponentials in
\eqref{Eq:alternative_harmonic_formulation_2_2} and thus we can use
FFTs to evaluate the summation of $C_{q,q',q''}(\ell,m)$ over $q$,
$q'$ and $q''$. First we need to compute $C_{q,q',q''}(\ell,m)$ for
each $\ell$ and for each $m$ which requires a one-dimensional
summation over three dimensional grid formed by $q$, $q'$ and $q''$
and thus can be computed in $O(L_h^4)$. Using
$C_{q,q',q''}(\ell,m)$, the summation over the complex exponentials
in \eqref{Eq:alternative_harmonic_formulation_2_2} can be carried
out in $O(L_h^3\log_2 L_h)$ using FFTs.  The overall complexity of
this approach is dominated by the computation of
$C_{q,q',q''}(\ell,m)$, that is, $O(L_h^4)$ for each SLSHT
distribution component and $O(L_f^2 L_h^4)$ for the complete SLSHT
distribution.
%
We note that the evaluation of $C_{q,q',q''}(\ell,m)$ requires the
computation of $\Delta^p_{q q'}$ which can be evaluated over the
$(q,q')$ plane for each $p$ using the recursion formula
of~\cite{Trapani:2006} with a complexity of $O(L_h^2)$. Since $p$ is
of order $L_h$, the $\Delta$ matrices can be evaluated in
$O(L_h^3)$, which does not change the overall complexity of our
proposed algorithm. The overall asymptotic complexity of our fast
algorithm is thus $O(L_f^3 L_h^2 + L_f^2 L_h^4)$.
%

\begin{remark}
Since the complexity to compute the spherical harmonic transform of
the modulated signal ${\overline{f}\,Y_\ell^m}$ up to degree $L_h$
is $O(L_f^2 \log_2 L_f + L_f L_h^2)$ for each $\ell,\,m$, the complexity of our fast algorithm to compute
one SLSHT distribution component is $O(L_f^2 \log_2 L_f + L_f L_h^2+
L_h^4)$. The factor $L_f^2 \log_2 L_f$ in the complexity does not
change if we compute spherical harmonic transform of
${\overline{f}\,Y_\ell^m}$ up to degree $L_h$ for all $\ell,\,m$
instead of each $\ell,\,m$.
\end{remark}

\begin{remark}
  In order to evaluate
  \eqref{Eq:alternative_harmonic_formulation_wigner}, we note that the
  separation of variables approach~\cite{Wiaux:2006} can be used as an
  alternative to the factoring of rotation approach to develop a fast
  algorithm. This is due to the factorized form of \mbox{Wigner-$D$}
  function and consideration of the equiangular tessellation scheme
  for \emph{SO(3)}, which keeps the independence between the samples along
  different Euler angles. In terms of computational complexity,
  the separation of variable approach has the same computational
  complexity as the factoring of rotation approach. However, the
  separation of variable approach needs to compute Wigner-$d$
  functions for all values of $\vartheta$ but only requires a two dimensional FFT,
  whereas the factoring of rotation approach only requires the
  evaluation of Wigner-$d$ function for $\pi/2$ but requires a three dimensional
  FFT. Since both approaches have the same complexity, we use the
  factoring of rotation in our implementation of the fast algorithm.
\end{remark}

\begin{remark}
  If we want to analyze the signal $f$ with multiple window functions,
  then we do not need to recalculate the spherical harmonic transform
  of the modulated signal $\overline{f}\,Y_\ell^m$, which accounts for
  the $O(L_f^3 L_h^2)$ factor in the overall complexity. Once it is
  computed, the SLSHT distribution can be computed in $O(L_f^2L_h^4)$
  time for each window function of the same band-limit using the proposed efficient
  implementation.
\end{remark}

Our proposed formulation and efficient implementation can be further
optimized in the case of a steerable window function.  Steerable
functions have an azimuthal harmonic band-limit in $m$ that is less
than the band-limit in $\ell$ (see \cite{Wiaux:2005,Wiaux:2006} for
further details about steerability on the sphere).  In this case,
the $L_f^2 L_h^4$ factor contributing to the overall asymptotic
complexity of the fast algorithm is reduced to $L_f^2 L_h^3$.
Furthermore, we may then compute the directional SLSHT for any
continuous $\omega\in[0,2\pi)$ from a small number of basis
orientations (due to the linearity of the SLSHT).

If the signal and window function are real, the computational time
can be further reduced by considering the conjugate symmetry
relation of the spherical harmonic coefficients. Furthermore, in
this setting, the SLSHT distribution components also satisfy the
conjugate symmetry property
%
\begin{align}
g(\rho;\ell,-m) = (-1)^m\,\overline{g(\rho;\ell,m)}
\end{align}
%
and we do not need to compute the SLSHT distribution components of
negative orders.

\section{Window Localization in Spatial and Spectral Domains}\label{sec:Window}

The directional SLSHT distribution is the spherical harmonic
transform of the product of two functions, the signal $f$ and the
rotated window function $h$ and we must be careful in interpreting
the directional SLSHT distribution in the sense that we do not
mistake using the signal to study the window because there is no
distinction mathematically. The window function should be chosen
such that it provides spatial localization in some spatial region
around the north pole~(origin). Since we have considered a
band-limited window function, the window function cannot be
perfectly localized in the spatial domain due to the uncertainty
principle on the sphere~\cite{Freeden:1999}. However, it can be
optimally localized by maximizing the energy concentration of the
window function in the desired directional
region~\cite{Simons:2006}.

The interpretation of the directional SLSHT
distribution depends on the chosen window function. The window
function with maximum localization in some defined asymmetric region
provides directional localization and thus reveals directional
features in the spatio-spectral domain. The more directional the
window function, the more directional features it can reveal in the
spatio-spectral domain but this tends to increase the maximum
spherical harmonic degree $L_h$. Recall that the maximum degree of
the directional SLSHT distribution components is given by $L_g =
L_f+L_h$. Thus, when the signal is expressed in the spatio-spectral
domain its spectral extent is extended by $L_h$, which results in
spectral leakage. Therefore, we want the window function to be
simultaneously maximally localized in some spatial region
$\mathcal{R}\subset\mathbb{S}^2$ and have the minimum possible
band-limit which achieves the desired level of energy concentration
in the spatial region $\mathcal{R}$.

Here, we propose using a band-limited eigenfunction obtained from
the solution of the Slepian concentration problem~\cite{Simons:2006}
as a window function, concentrated in a spatially localized
elliptical region around the north pole.  We first parameterize the
elliptical region and later analyze the resulting eigenfunctions
from the perspective of the uncertainty principle on the
sphere~\cite{Freeden:1999}. We note that the choice of the
asymmetric region as an elliptical region is only one possibility
and the analysis can be extended to other asymmetric regions such as
strip regions around the north pole~\cite{Khalid_icspcs:2011}.


%%----------------------------------------------------------------------
%%%----------------------------------------------------------------------
\begin{figure*}[!ht]
    \centering
    \subfloat[]{
        \includegraphics[scale=0.35]{eigen_window_3_new}}

    \subfloat[]{
        \includegraphics[scale=0.35]{eigen_window_2_new}}

    \subfloat[]{
        \includegraphics[scale=0.35]{eigen_window_1_new}}\vspace{2mm}
    \caption{Band-limited eigenfunction windows $h$ on the sphere with $90\%$ spatial
    concentration in an elliptical region
$\mathcal{R}_{(\thetac,a)}$ of focus $\thetac = \pi/6$ and major
axis: (a) $a = \pi/6+\pi/80$, (b) $a = \pi/6+\pi/120$ and (c) $a =
\pi/6+\pi/240$. } \label{fig:eigenwindows}
\end{figure*}
%%----------------------------------------------------------------------

\subsection{Parametrization of Window Function}

We consider a band-limited window function of maximum spherical
harmonic degree $L_h$, which is spatially concentrated in the
elliptical region on the sphere with major axis along the $x$-axis,
and thus is orientated along the $x$-axis. The elliptical region can
be parameterized using the focus colatitude $\thetac$ of the ellipse
along the positive $x$-axis and the arc length $a$ of the semi-major
axis:
%
\begin{align}\label{Eq:region_def}
\mathcal{R}_{(\thetac,a)} \triangleq \big\{ (\theta,\phi):\,
\triangle_s\big((\theta,\phi ), (\thetac,0)\big) +
\triangle_s\big((\theta,\phi ), (\thetac,\pi)\big) \leq 2a \big\},
\end{align}
%
where $0 \leq \thetac \leq a \leq \pi/2$. Here
$\triangle_s\big((\theta,\phi ), (\theta',\phi')\big) = \arccos
\big( \sin\theta\sin\theta'\cos(\phi-\phi') +
  \cos\theta\cos\theta'\big)$ denotes the angular
distance between two points $(\theta,\phi)$ and $(\theta',\phi')$ on
the sphere. We note that the elliptical region defined in \eqref{Eq:region_def} takes into account the angular distances and should not be confused with the projection of an ellipse in the tangent space into $\untsph$.
%
\begin{remark}
  For a given focus $\thetac$, the region becomes more directional as the arc length $a$ approaches $\theta_c$ from $\pi/2$. For $a=\pi/2$, the region becomes
  azimuthally symmetric, i.e., we recover the polar cap of central
  angle $\pi/2$. Also, when $\theta_c=0$, the region becomes azimuthally symmetric~(polar cap) of central angle $a$.
\end{remark}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
\begin{figure*}[tb]
    \centering
    \includegraphics[scale=0.6]{eigen_values_1.pdf}\vspace{2mm}
    \caption{The maximum eigenvalue $\lambda_{\max}$ corresponding to the
      eigenfunction $h$, obtained as a solution of Slepian concentration problem on the sphere, with spherical harmonic band-limit $L$ for
      spatial concentration in an elliptical region of focus
      $\thetac=\pi/6$ and major axis $a$ as indicated. Black vertical
      lines indicate the bound on the band-limit $B_h$ given by
      \eqref{Eq:bound_Lh} and the gray vertical lines indicate the
      actual $L_h$ which ensures $90\%$ concentration in an
      elliptical region.}
    \label{fig:eigen_spectrum}
\end{figure*}
%%----------------------------------------------------------------------

\subsection{Slepian Concentration Problem}
%
As a result of the Slepian concentration
problem~\cite{Khalid_icspcs:2011,Simons:2006} to find the
band-limited function with bandwidth $L_h$ and maximal spatial
concentration in an elliptical region $\mathcal{R}_{(\thetac,a)}$,
we obtain $(L_h+1)^2$ eigenfunctions. Due to the symmetry of the
elliptical region about the $x$-$y$ plane, the eigenfunctions are real
valued~\cite{Khalid_icspcs:2011}. The eigenvalue associated with
each eigenfunction serves as a measure of the energy concentration
in the spatial region. Here we consider the use of the band-limited
eigenfunction with maximum energy concentration in the elliptical
region for given band-limit $L_h$ and refer to such an eigenfunction
as the eigenfunction window. If $A$ denotes the area of the
elliptical region, it is shown~\cite{Khalid_icspcs:2011,Simons:2006}
that most of the eigenvalues lie either near zero or unity for both
symmetric and asymmetric regions and the sum of all eigenvalues,
referred as an equivalent of the Shannon number~\cite{Simons:2006},
is equal to $N_0= {A}(L_h+1)^2/{(4\pi)}$. Also, it is shown
empirically in \cite{Wieczorek:2005} that there exist no more than $N_0-1$ spatially concentrated eigenfunctions with
significant energy concentration. By noting these developments
and empirical results, and considering that $L_h$ must be chosen
so that we obtain at least one eigenfunction that is spatially
concentrated in the elliptical region, we recover the following
empirical lower bound for $L_h$:
\begin{align}\label{Eq:bound_Lh}
L_h \gtrsim  B_h\,=\,2 \bigg\lceil
\sqrt{\frac{2\pi}{A}}\,\bigg\rceil-1,\,\, A =
\int_{\mathcal{R}_{(\thetac,a)}} ds(\dv{x}),
\end{align}
where $\lceil\, (\cdot) \,\rceil$ denotes the integer ceiling
function (this bound follows directly from $N_0\gtrsim 2$). We
analyze this bound later in this section.

Let $\lambda_{\max}$ denote the eigenvalue associated with the most
spatially concentrated eigenfunction. By finding the minimum value
of $L_h$ which ensures that $\lambda_{\max}$ is greater than or
equal to the desired energy concentration, an eigenfunction window
$h(\unit{x})$ with desired energy concentration in the elliptical
region and minimum possible band-limit $L_h$ can be obtained.
 Thus,
the focus of an elliptical region $\theta_c$, arc length of
semi-major axis $a$ and maximum spectral degree $L_h$ fully
parameterize the eigenfunction window. As an illustration, the three
eigenfunction windows having $90\%$ spatial concentration in the
elliptical regions $\mathcal{R}_{(\thetac,a)}$ with focus
$\thetac=\pi/6$ and $a \in \{
\pi/6+\pi/240,\,\pi/6+\pi/120,\,\pi/6+\pi/80 \}$ and respective
maximum spherical harmonic degree $L_h \in \{ 18,\,14,\,11\}$ are
shown in \figref{fig:eigenwindows}. For these elliptical regions, in
\figref{fig:eigen_spectrum} we show $\lambda_{\max}$ versus
spherical harmonic band-limit $L$ denoting the band-limit of the
most concentrated eigenfunction window, where we note the difference
in $L_h$ and the bound $B_h$ for the desired concentration level.
For a desired concentration level of $90\%$, we observe that the
spherical harmonic degree $L_h$ which ensures $\lambda_{\max}
\geq0.9$ deviates further from the bound $B_h$ given by
\eqref{Eq:bound_Lh} as the concentration region becomes more
directional (as expected since the bound does not incorporate the
level of directionality of the region).




\subsection{Analysis of Eigenfunction Window Concentrated in Elliptical Region}

\subsubsection{Directionality}

For the use of the eigenfunction window in obtaining the directional
SLSHT distribution, the directionality of the eigenfunction window
must be a key criterion in selecting the eigenfunction window for
the identification of localized features of a signal in the
spatio-spectral domain. We use the definition of the
auto-correlation function on the sphere as a measure of the
directionality of the eigenfunction
window~\cite{Wiaux:2005,Wiaux:2008}. The auto-correlation function
is defined as the inner product of the eigenfunction window with its
version rotated around the $z$-axis:
%
\begin{align}\label{Eq:correlation}
C_h(\varsigma)\,=\, \langle D_{\rho_1}h,\,h \rangle\,,\quad \rho_1 =
(0,0,\varsigma),\, \varsigma\in[0,\frac{\pi}{2}],
\end{align}
%
which can be expressed in the harmonic domain as
%
\begin{align}\label{Eq:correlation_harmonic}
C_h(\varsigma)\,=\, \sum_{\ell=0}^{L_h}\sum_{m=-\ell}^{\ell}
e^{im\varsigma}|\shc{h}{\ell}{m}|^2 .
\end{align}
%
%where we have employed the orthonormal property of the spherical
%harmonics, incorporated \eqref{eqn:rotation_non_symm} and
%\eqref{Eq:Dlm} and used the property of Wigner-$d$ function that
%$d^\ell_{m,m'}(0) = \delta_{mm'}$.
%
Due to the symmetry of the elliptical region and the eigenfunction
window about the major axis~($x$-axis) and minor axis~($y$-axis), we
have considered $\varsigma$ in the range of $0$ to $\pi/2$.

For the eigenfunction windows presented in the previous subsection,
the auto-correlation function for each window is shown in
\figref{fig:corr}, which indicates that $C_h(\varsigma)$ decays more
rapidly from unity at $\varsigma=0$ for more directional windows and
therefore, the peakedness of $C_h(\varsigma)$ quantifies the ability
of the window function to spatially localize the directional features
of a signal.
%
%%----------------------------------------------------------------------
%
\begin{figure*}[!t]
    \centering
    \includegraphics[scale=0.6]{corr.pdf}\vspace{2mm}
    \caption{Auto-correlation function $C_h(\varsigma)$ as described in \eqref{Eq:correlation} for eigenfunction windows $h$ with spatial concentration in an
elliptical region of focus $\thetac = \pi/6$ and major axis $a$ as
indicated.}
    \label{fig:corr}
\end{figure*}
%%----------------------------------------------------------------------
%
%-----------------------------------------------------------------------------
\begin{figure*}[tb]
    \centering
    \includegraphics[scale=0.6]{product.pdf}\vspace{2mm}
 \caption{Spatial variance ($20\sigma_\textrm{S}^2$), spectral variance
($\sigma_\textrm{L}^2$) and uncertainty product, as described in
\eqref{Eq:uncertain_prod}, \eqref{Eq:sigma_S} and
\eqref{Eq:sigma_L}, are shown for eigenfunctions with spatial
concentration in an elliptical region of focus $\thetac = \pi/6$ and
major axis $a$ as indicated.}
    \label{fig:product}
\end{figure*}

\subsubsection{Spatial and Spectral Localization}

Here we study the spatial and spectral localization of eigenfunction
windows from the perspective of the uncertainty principle on the
sphere~\cite{Freeden:1999,Narcowich:1996}, according to which, the
function cannot be simultaneously localized in both the spatial and
spectral domains. The following inequality specifies the uncertainty
principle for unit energy functions defined on the sphere, which
relates the trade-off between the spatial and spectral localization
of a function:
%
\begin{align}
\frac{\sigma_{\textrm{S}}}{\sqrt{1-\sigma_{\textrm{S}}^2}}\cdot
\sigma_{\textrm{L}} &\geq 1 \label{Eq:uncertain_prod} ,
\end{align}
%
\noindent where $\sigma_{\textrm{S}}$ and $\sigma_{\textrm{L}}$
denote the variance of the band-limited unit energy eigenfunction
window in the spatial domain and spectral domain respectively and
are defined as~\cite{Narcowich:1996}
%
\begin{align}
\sigma_{\textrm{S}}^2 &= 1 - \Bigg(\frac{1}{2} \intsph \sin
(2\theta)\, \big|h(\theta,\phi)\big|^2\,d\theta d\phi \,\Bigg)^2
\label{Eq:sigma_S}
\end{align}
and
\begin{align}
\sigma_{\textrm{L}}^2 &= \sum_{\ell=0}^{L_h} \ell (\ell+1)
\sum_{m=-\ell}^{\ell} |h_{\ell}^m|^2 . \label{Eq:sigma_L}
\end{align}
%
Due to the consideration of unit energy functions, $0\leq \sigma_S
\leq 1$. We note that smaller variance indicates better localization
of the window function. The variance in the spatial and spectral
domains and the uncertainty product for eigenfunctions concentrated
in an elliptical region of focus $\pi/6$ and major-axis of different
values are shown in Fig.~\ref{fig:product}. As expected, the
variance in the spatial domain decreases as the region becomes more
directional, whereas the variance in the spectral domain increases
because $L_h$ increases. We also note that the uncertainty product
increases as the region becomes more directional.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure*}[!ht]
    \centering

    \subfloat[Computation time to evaluate $(\overline{f} Y_\ell^m)_p^q$]
        {\label{fig:time1a}\includegraphics[scale=0.45]{comp_time_T1}}
    \hspace{5mm}
    \subfloat[Computation time to evaluate all SLSHT distribution
    components given $(\overline{f} Y_\ell^m)_p^q$ ]
        {\label{fig:time1b}\includegraphics[scale=0.45]{comp_time_T2}}

    \subfloat[Inverse transform computation time]
        {\label{fig:time2}\includegraphics[scale=0.45]{comp_time_2}}
    \hspace{5mm}
    \subfloat[Numerical validation]
        {\label{fig:error}\includegraphics[scale=0.45]{error}}

    \caption{Numerical validation and computation time of the proposed
      algorithms. Computation time in seconds: (a) $\tau_1$ (b)
      $\tau_2$ and (c) $\tau_3$. For fixed $L_h$, $\tau_1$ evolves as $O(L_f^3)$ and
      both $\tau_2$ and $\tau_3$ scale as $O(L_f^2)$ as shown by the
      solid red lines~(without markers). (d) The maximum error
      $\epsilon$, which empirically appears to scale as $O(L)$, as
      shown by the solid red line. }
    \label{fig:simulations_1}
\end{figure*}
%%----------------------------------------------------------------------------------------------------

\section{Results}\label{sec:results}

In this section, we first demonstrate the numerical validation and
computation time of our algorithms to evaluate the directional SLSHT
components. Later, we provide an example to illustrate the
capability of the directional SLSHT, showing that it probes out the
directional features of signals in the spatio-spectral domain. The
implementation of the our algorithms is carried out in
\texttt{MATLAB}, using the \texttt{MATLAB} interface of the
\texttt{SSHT}\footnote{\url{http://www.jasonmcewen.org/}} package
(the core algorithms of which are written in $\texttt{C}$ and which
also uses the \texttt{FFTW}\footnote{\url{http://www.fftw.org/}}
package to compute Fourier transforms) to efficiently compute
forward and inverse spherical harmonic
transforms~\cite{McEwen:2011}.


\subsection{Numerical Validation and Computation Time}
In order to evaluate the numerical accuracy and the computation
time, we carry out the following numerical experiment. We use the
band-limited function $h$ for spatial localization with band-limit
$L_h=18$ and spatial localization in the region
$\mathcal{R}_{(\pi/6,\pi/6+\pi/240)}$. We generate band-limited test
signals with band-limits $18\leq L_f\leq 130$ by generating
spherical harmonic coefficients with real and imaginary parts
uniformly distributed in the interval $[0,1]$.

For the given test signal, we measure the computation time $\tau_1$
to evaluate spherical harmonic transform of the modulated signal,
i.e., $(\overline{f}Y_\ell^m)_p^q$ for $p\leq L_h, \,q\leq|p|$ and
for all $\ell\leq L_f+L_h,\, m\leq|\ell|$, using the method
presented in Section~\ref{sec:Algos:fast}. Given the spherical
harmonic transform of the modulated signal, we then measure the
computation time $\tau_2$ to compute all directional SLSHT
distribution components $g(\rho;\ell,m)$ for $\ell\leq L_f+L_h$ and
$m\leq|\ell|$ using our fast algorithm presented in
Section~\ref{sec:Algos:fast}, where we compute the Wigner-$d$
functions on-the-fly for the argument $\pi/2$ by using the recursion
of Trapani~\cite{Trapani:2006}. We also record the computation time
$\tau_3$ to recover a signal from its SLSHT distribution components.
All numerical experiments are performed using \texttt{MATLAB}
running on a 2.4 GHz Intel Xeon processor with 64 GB of RAM and the
results are averaged over ten test signals. The computation time
$\tau_1$ and $\tau_2$ are plotted against the band-limit $L_f$ of
the test signal in \figref{fig:time1a} and \figref{fig:time1b},
which respectively evolve as $O(L_f^3)$ and $O(L_f^2)$ for fixed
$L_h$ and thus corroborate the theoretical complexity. The
computation time $\tau_3$ for the inverse directional SLSHT is
plotted in \figref{fig:time2}, which scales as $O(L_f^2)$ for fixed
$L_h$, again supporting the theoretical complexity.

We reconstruct the original signal from its SLSHT distribution
components using \eqref{Eq:sig_reconstruction_discrete} and
\eqref{Eq:inversion_1}, in order to assess the numerical accuracy of
our algorithms by measuring the maximum absolute error between the
original spherical harmonic coefficients of the test signal and the
reconstructed values. The maximum absolute error is plotted in
\figref{fig:error} for different band-limits $L_f$, which
illustrates that our algorithms achieve very good numerical accuracy
with numerical errors at the level of floating point precision.


\subsection{Directional SLSHT Illustration}

In this subsection, we provide examples to illustrate the capability
of the proposed transform to reveal the localized contribution of
spectral contents and probe directional features in the
spatio-spectral domain.

%%----------------------------------------------------------------------------------------------------
\begin{figure*}[!t]
 \centering
    \vspace{-5mm}
    \hspace{-5mm}
    \subfloat[$f_1$]{
        \includegraphics[scale=0.28]{comps/earth_signal}}
        \hspace{5mm}
   \subfloat[$f_2$]{
        \includegraphics[scale=0.28]{comps/high_signal}}
        \hspace{5mm}
    \subfloat[$f$]{
        \includegraphics[scale=0.28]{comps/syn_signal}}

 \caption{(a) Spectrally truncated unit energy normalized Earth topographic map $f_1$ and (b) signal $f_2$ composed
of higher degree spherical harmonics localized in elliptical
regions. (c) Weighted sum of $f_1$ and $f_2$ as defined in
\eqref{Eq:syn_signal_sum}.} \label{fig:syn_sig}\vspace{-0.25in}
\end{figure*}
%%--------------------------------------------
%
\subsubsection{Example 1 - Synthetic Data Set}
We first construct a signal having localized contribution of higher
degree spectral contents and then analyze the signal using proposed
directional SLSHT. Let signal $f_1$ be the spectrally truncated,
unit energy normalized Earth topographic map with band-limit
$L_{f_1}=30$, which is obtained by using spherical harmonic model of
topography of Earth and is shown in \figref{fig:syn_sig}a. Also
consider the signal $f_2$ composed of higher degree spherical
harmonics localized in two non-overlapping elliptical regions with
different orientation. We obtain such a signal $f_2$ by spectrally
truncating the following signal $\tilde{f}_2$ with in the band-limit
$L_{f_2} = 128$,
\begin{align}
\tilde{f}_2(\unit{x}) &= \begin{cases}
\sum\limits_{\ell=40}^{45}\left( Y_\ell^{20}(\unit{x})+
Y_\ell^{-20}(\unit{x})\right) &
\unit{x}\in\mathcal{R} = \mathcal{R}_1 \cup \mathcal{R}_1 \\
0 & \unit{x}\in \mathbb{S}^2 \setminus \mathcal{R},
\end{cases}
\end{align}
where $\mathcal{R}_1$ and $\mathcal{R}_2$ are the elliptical regions
of the form $\mathcal{R}_{(\pi/6,\pi/6+\pi/240)}$, respectively
rotated by $(\pi/2,\pi/2,0)\in\textrm{SO(3)}$ and
$(3\pi/2,\pi/2,\pi/2)\in\textrm{SO(3)}$. The unit energy normalized
signal $f_2$ is shown in \figref{fig:syn_sig}b. We note that the
regions $\mathcal{R}_1$ and $\mathcal{R}_2$ have orientation along
colatitude and longitude respectively.

We analyze the following synthetic signal using the proposed
transform
\begin{align}\label{Eq:syn_signal_sum}
f(\unit{x}) &= 10^3 \times \left( \frac{f_1(\unit{x})}{\|f_1\|} +
\frac{f_2(\unit{x})}{4\|f_2\|} \right),
\end{align}
which can be considered as a sum of a low frequency signal and a high
frequency localized signal. The signal $f$ is shown in
\figref{fig:syn_sig}c, where it can be observed that the information
cannot be obtained about the presence of higher degree spherical
harmonics localized in different directional regions. Furthermore,
the spherical harmonic coefficients provide details about the
presence of higher degree spherical harmonics in the signal, but do
not reveal any information about the localized contribution of
higher degree spherical harmonics.

If we analyze the signal by employing the SLSHT using an azimuthally
symmetric window function, the presence of localized contributions
of higher degree spectral contents can be determined in the
spatio-spectral domain as we illustrated in Chapter~\ref{chap4:chapter4}. However, the presence of
directional features cannot be extracted. Here, we illustrate that
the use of the directional SLSHT enables the identification of
directional features in the spatio-spectral domain, which is due to
the consideration of an asymmetric window function for spatial
localization.

%------------------------------------------------------------------------
\begin{figure}[!ht]
 \centering
    \vspace{-5mm}
    \hspace{-5mm}
    \subfloat{
        \includegraphics[scale=0.24]{comps/eg41}}
   \subfloat{
        \includegraphics[scale=0.24]{comps/eg43}}
    \subfloat{
        \includegraphics[scale=0.24]{comps/eg45}}

        \vspace{-3mm}
       \setcounter{subfigure}{0}
       \centering
        \subfloat[]{}

    \hspace{-5mm}
    \subfloat{
        \includegraphics[scale=0.24]{comps/eg141}}
   \subfloat{
        \includegraphics[scale=0.24]{comps/eg143}}
    \subfloat{
        \includegraphics[scale=0.24]{comps/eg145}}

        \vspace{-3mm}
\setcounter{subfigure}{1}
        \subfloat[]{}

    \hspace{-5mm}
    \subfloat{
        \includegraphics[scale=0.24]{comps/eg21}}
   \subfloat{
        \includegraphics[scale=0.24]{comps/eg23}}
    \subfloat{
        \includegraphics[scale=0.24]{comps/eg25}}

        \vspace{-3mm}
       \setcounter{subfigure}{2}
        \subfloat[]{}

    \hspace{-5mm}
    \subfloat{
        \includegraphics[scale=0.24]{comps/eg121}}
   \subfloat{
        \includegraphics[scale=0.24]{comps/eg123}}
    \subfloat{
        \includegraphics[scale=0.24]{comps/eg125}}

    \centering
        \vspace{-3mm}
    \setcounter{subfigure}{3}
    \subfloat[]{}

 \caption{Magnitude of the components of the
directional SLSHT distribution of the synthetic signal shown in
\figref{fig:syn_sig}c. For fixed orientation $\gamma$ of the window
function around the $z$-axis, the distribution components
$g(\rho;\ell,m)$ are mapped on the sphere using $\rho =
(\phi,\theta,\gamma)$ for order $m=20$. The components are shown for
degrees $\ell\in \{41,43,45\}$ and for orientations (a) $\gamma=0$
and (b) $\gamma\approx\pi/2$ of the window function around the $z$-axis,
and the components are shown for degrees $\ell\in \{21,23,25\}$ and
for orientation (c) $\gamma=0$ and (d) $\gamma\approx\pi/2$. Top
left: $g(\rho;41,20)$, top right: $g(\rho;45,20)$. }
\label{fig:syn_comps}\vspace{-0.25in}
\end{figure}
%%--------------------------------------------

We obtain the directional SLSHT distribution components
$g(\rho;\ell,m)$ of the signal $f$ using the band-limited
eigenfunction window $h$ with $L_h=18$ and $90\%$ concentration in
the spatial domain in an elliptical region
$\mathcal{R}_{(\pi/6,\pi/6+\pi/240)}$. The magnitude of the SLSHT
distribution components $g(\rho;\ell,m)$ for order $m=20$ and for
degrees $\ell \in \{41,43,45\}$ are shown in \figref{fig:syn_comps}
for Euler angle (a) $\gamma=0$ and (b) $\gamma=100\pi/201
\approx\pi/2$, and for degrees $\ell \in \{21,23,25\}$, the
components are shown for (c) $\gamma=0$ and (d)
$\gamma\approx\pi/2$. Since the elliptical region is oriented along
the $x$-axis, the window with orientation $\gamma=0$ provides
localization along colatitude and the window with orientation
$\gamma\approx\pi/2$ provides localization along longitude. It can
be observed that the localized contribution of higher degree
directional spectral contents is extracted in spatio-spectral
domain. The localized higher degree directional features along the
orientation $\gamma=0$ and $\gamma\approx\pi/2$ are revealed in the
spatio-spectral domain as shown in \figref{fig:syn_comps}a and
\figref{fig:syn_comps}b respectively, which are not visible in lower
degree distribution components as shown in \figref{fig:syn_comps}c
and \figref{fig:syn_comps}d.

As demonstrated, the proposed directional SLSHT is capable of probing
localized directional spectral content. We further illustrate the
capability of our proposed transform by analyzing the Mars
topographic map in the spatio-spectral domain.

%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure*}[!t]
    \centering
    \includegraphics[scale=0.5]{mars_spatial_dslsht.pdf}\vspace{2mm}
    \caption{Mars signal in the spatial domain. The grand canyon Valles Marineris and the mountainous regions of Tharsis Montes and Olympus Mons are indicated. }
    \label{fig:mars_spatial}
\end{figure*}
%%----------------------------------------------------------------------
\begin{figure}[!th]
 \centering
    \hspace{-2mm}
    \subfloat{
        \includegraphics[scale=0.24]{comps/g20}}
   \subfloat{
        \includegraphics[scale=0.24]{comps/g21}}
    \subfloat{
        \includegraphics[scale=0.24]{comps/g22}}

    \hspace{-2mm}
    \subfloat{
        \includegraphics[scale=0.24]{comps/g23}}
   \subfloat{
        \includegraphics[scale=0.24]{comps/g24}}
    \subfloat{
        \includegraphics[scale=0.24]{comps/g25}}
       \setcounter{subfigure}{0}

   \subfloat[]{}

    \hspace{-2mm}
    \subfloat{
        \includegraphics[scale=0.24]{comps/g120}}
   \subfloat{
        \includegraphics[scale=0.24]{comps/g121}}
    \subfloat{
        \includegraphics[scale=0.24]{comps/g122}}

    \hspace{-2mm}
    \subfloat{
        \includegraphics[scale=0.24]{comps/g123}}
   \subfloat{
        \includegraphics[scale=0.24]{comps/g124}}
    \subfloat{
        \includegraphics[scale=0.24]{comps/g125}}
       \setcounter{subfigure}{1}


   \subfloat[]{}

\caption{Magnitude of the components of the directional SLSHT
distribution of the Mars signal obtained using the eigenfunction
window concentrated in an elliptical region of focus
$\thetac=\pi/12$ and major axis $a=7\pi/12$. For fixed orientation
$\omega$, the distribution components $g(\rho;\ell,m)$ are mapped on
the sphere using $\rho = (\phi,\theta,\omega)$ for order $m=15$ and
degree $20\leq \ell\leq25$. The components are shown for orientation
(a) $\omega=0$ and (b) $\omega\approx\pi/2$ of the window function
around the $z$-axis. Top left: $g(\rho;20,15)$, top right:
$g(\rho;22,15)$. } \label{fig:mars_comps_1}
\end{figure}
%%----------------------------------------------------------------------

\subsubsection{Example 2 - Mars Data Set}
We consider the Mars topographic map~(height above geoid) as a
signal on the sphere, which is obtained by using the spherical
harmonic model of the topography of
Mars\footnote{\url{http://www.ipgp.fr/~wieczor/SH/}}. The Mars
topographic map is shown in \figref{fig:mars_spatial} in the spatial
domain, where the grand canyon Valles Marineris and the mountainous
regions of Tharsis Montes and Olympus Mons are shown, indicating the presence of
high frequency contents. We note that the mountainous regions
are non-directional features of the Mars map, whereas the grand
canyon serves as a directional feature with direction oriented
along a line of approximate constant latitude. The spherical
harmonic coefficients provide details about the presence of higher
degree spherical harmonics in the signal, but do not reveal any
information about the localized contribution of higher degree
spherical harmonics, meaning that the spherical
harmonic coefficients do not directly enlighten the information about the the spatial localization of spectral contents.

We obtain the directional SLSHT distribution components
$g(\rho;\ell,m)$ of the Mars map $f$ using the band-limited
eigenfunction window $h$ with $L_h=60$ and $90\%$ concentration in
the spatial domain in an elliptical region
$\mathcal{R}_{(\pi/12,7\pi/12)}$. The magnitude of the SLSHT
distribution components $g(\rho;\ell,m)$ for order $m=15$ and
degrees $20 \leq \ell \leq 25$ and $50 \leq \ell \leq 55$ are shown
in \figref{fig:mars_comps_1} and \figref{fig:mars_comps_2}
respectively, where the components in the panels are for Euler angles
(a) $\omega=0$ and (b) $\omega=100\pi/201 \approx\pi/2$. Since the
elliptical region is oriented along the $x$-axis, the window with
orientation $\omega=0$ provides localization along colatitude and
the window with orientation $\omega\approx\pi/2$ provides
localization along longitude. It is evident that using orientation
of the window $\omega\approx\pi/2$ probes the information about the
grand canyon Valles Marineris~(directional feature) along longitude
in the spatio-spectral domain. The localized contribution of higher
degree spherical harmonics towards the mountainous region can also
be observed in \figref{fig:mars_comps_1} for degree $20\leq \ell
\leq 25$ and both $\omega=0$ and $\omega~=\pi/2$. However, there is
not significant contribution of spherical harmonics of degree
$50\leq\ell\leq 55$ towards the mountainous region as indicated in
\figref{fig:mars_comps_2}a where $\omega=0$, but the localization of
the directional features along the orientation $\omega\approx\pi/2$
are revealed in the spatio-spectral domain as shown in
\figref{fig:mars_comps_2}b. Due to the ability of the directional
SLSHT to reveal the localized contribution of spectral contents and
the directional or oriented features in the spatio-spectral domain,
it can be useful in many applications where the signal on the sphere
is localized in position and orientation.

%------------------------------------------------------------------------
\begin{figure}[!th]
 \centering
    \hspace{-5mm}
    \subfloat{
        \includegraphics[scale=0.24]{comps/g50}}
   \subfloat{
        \includegraphics[scale=0.24]{comps/g51}}
    \subfloat{
        \includegraphics[scale=0.24]{comps/g52}}

    \hspace{-5mm}
    \subfloat{
        \includegraphics[scale=0.24]{comps/g53}}
   \subfloat{
        \includegraphics[scale=0.24]{comps/g54}}
    \subfloat{
        \includegraphics[scale=0.24]{comps/g55}}
       \setcounter{subfigure}{0}

   \subfloat[]{}

    \hspace{-5mm}
    \subfloat{
        \includegraphics[scale=0.24]{comps/g150}}
   \subfloat{
        \includegraphics[scale=0.24]{comps/g151}}
    \subfloat{
        \includegraphics[scale=0.24]{comps/g152}}

    \hspace{-5mm}
    \subfloat{
        \includegraphics[scale=0.24]{comps/g153}}
   \subfloat{
        \includegraphics[scale=0.24]{comps/g154}}
    \subfloat{
        \includegraphics[scale=0.24]{comps/g155}}
       \setcounter{subfigure}{1}


   \subfloat[]{}

 \caption{Magnitude of the components of the
directional SLSHT distribution of the Mars signal obtained using the
eigenfunction window concentrated in an elliptical region of focus
$\thetac=\pi/12$ and major axis $a=7\pi/12$. For fixed orientation
$\omega$, the distribution components $g(\rho;\ell,m)$ are mapped on
the sphere using $\rho = (\phi,\theta,\omega)$ for order $m=15$ and
degree $50\leq \ell\leq55$. The components are shown for orientation
(a) $\omega=0$ and (b) $\omega\approx\pi/2$ of the window function
around $z$-axis. Top left: $g(\rho;50,15)$, top right:
$g(\rho;52,15)$. } \label{fig:mars_comps_2}
\end{figure}
%%----------------------------------------------------------------------


\section{Summary of Contributions}\label{ch6:sec:conclusions}

In this chapter, we have presented the directional SLSHT to project
a signal on the sphere onto its joint spatio-spectral domain as a
directional SLSHT distribution. The directional SLSHT has been
defined as localized spherical harmonic transform, where we have
proposed the use of an azimuthally asymmetric window function to
obtain SO(3) spatial localization, which enables the transform to
resolve directional features in the spatio-spectral domain. The
contributions made in this chapter are as follows.

Addressing Q8 posed in Section~\ref{sec:intro_questions}:

\begin{itemize}
\item Extending the SLSHT distribution formulated in Chapter 4, here, we
have presented directional SLSHT to obtain such a spatio-spectral
representation that reveals the localized contribution of
directional features in the spatio-spectral domain. We have also
provided the harmonic analysis of directional SLSHT and presented an
inversion relation to synthesize the original signal from its
directional SLSHT distribution.

\item We have analyzed the band-limited window function obtained from the
Slepian concentration problem on the sphere, with nominal
concentration in an elliptical region around the north pole.

\item We provided an illustration which
highlighted the capability of the directional SLSHT to reveal
directional features in the spatio-spectral domain.


\end{itemize}

Addressing Q9 posed in Section~\ref{sec:intro_questions}:

\begin{itemize}
\item  We have developed a fast
algorithm for the efficient computation of the directional SLSHT
distribution of a signal. The computational complexity of the
proposed fast algorithm to evaluate SLSHT distribution of a signal
with band-limit $L_f$ using window function with band-limit $L_h$ is
$O(L_f^3 L_h^2 + L_f^2 L_h^4)$ as compared to the complexity of
direct evaluation, which is $O(L_f^4L_h^3)$.

\item We have also studied the numerical accuracy and the speed of our fast
algorithm and shown that the simulation results corroborate
theoretically evaluated computational complexities.
\end{itemize}
